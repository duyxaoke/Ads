@model Cash4Aff.Application.ViewModels.Cash4Aff.AdsViewModel
@{
    ViewBag.Title = "Index";
    Layout = null;
}
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title> Xeloro - Admin & Dashboard Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta content="Premium Multipurpose Admin & Dashboard Template" name="description" />
    <meta content="MyraStudio" name="author" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- App favicon -->
    <link rel="shortcut icon" href="assets/images/favicon.ico">

    <!-- App css -->
    <link href="~/content/vertical/assets/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
    <link href="~/content/vertical/assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <link href="~/content/vertical/assets/css/theme.min.css" rel="stylesheet" type="text/css" />
    <style>
        .canvas {
            height: 100%;
            width: 100%;
            position: relative;
            background: #2ecc71;
            vertical-align: middle;
            text-align: center;
        }

        .content-box {
            position: absolute;
            left: 50%;
            top: 50%;
            -webkit-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
        }

        .timer-bar {
            border-top: 10px solid rgba(0,0,0,.5);
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            -webkit-transition: width .5s ease;
            z-index: 10;
        }

        .timer-display {
            font-size: 100px;
            color: #fff;
        }

        .timer-info {
            color: rgba(0,0,0,.5);
            font-size: 20px;
            margin-bottom: 25px;
        }

        .finishing {
            -webkit-animation: blink 10s ease forwards;
        }

        .green-to-orange {
            -webkit-animation: green-to-orange forwards;
        }

        .orange-to-yellow {
            -webkit-animation: orange-to-yellow forwards;
        }

        .yellow-to-red {
            -webkit-animation: yellow-to-red forwards;
        }

        @@-webkit-keyframes green-to-orange {
            0% {
                background: #2ecc71;
            }

            100% {
                background: #2ecc71;
            }
        }

        @@-webkit-keyframes orange-to-yellow {
            0% {
                background: #2ecc71;
            }

            100% {
                background: #2ecc71;
            }
        }

        @@-webkit-keyframes yellow-to-red {
            0% {
                background: #2ecc71;
            }

            100% {
                background: #2ecc71;
            }
        }

        @@-webkit-keyframes blink {
            0% {
                opacity: 1;
            }

            3% {
                opacity: 0;
            }

            6% {
                opacity: 1;
            }

            9% {
                opacity: 0;
            }

            12% {
                opacity: 1;
            }

            15% {
                opacity: 0;
            }

            18% {
                opacity: 1;
            }

            21% {
                opacity: 0;
            }

            24% {
                opacity: 1;
            }

            27% {
                opacity: 0;
            }

            30% {
                opacity: 1;
            }

            33% {
                opacity: 0;
            }

            36% {
                opacity: 1;
            }

            39% {
                opacity: 0;
            }

            42% {
                opacity: 1;
            }

            45% {
                opacity: 0;
            }

            48% {
                opacity: 1;
            }

            51% {
                opacity: 0;
            }

            54% {
                opacity: 1;
            }

            57% {
                opacity: 0;
            }

            60% {
                opacity: 1;
            }

            63% {
                opacity: 0;
            }

            66% {
                opacity: 1;
            }

            69% {
                opacity: 0;
            }

            72% {
                opacity: 1;
            }

            75% {
                opacity: 0;
            }

            78% {
                opacity: 1;
            }

            81% {
                opacity: 0;
            }

            84% {
                opacity: 1;
            }

            87% {
                opacity: 0;
            }

            90% {
                opacity: 1;
            }

            93% {
                opacity: 0;
            }

            96% {
                opacity: 1;
            }

            99% {
                opacity: 0;
            }

            100% {
                opacity: 1;
            }
        }
    </style>

</head>
<body>

    <div class="bg-color-grayDark">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="d-flex align-items-center min-vh-100">
                        <div class="w-100 d-block bg-white shadow-lg rounded my-5">
                            <div class="row">
                                <div class="col-lg-5 d-none d-lg-block rounded-left">
                                    <div class="canvas">
                                        <div class="timer-bar"></div>
                                        <div class="content-box">
                                            <div class="timer-display">00:15</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-7">
                                    <div class="p-5">
                                        <div class="text-center mb-3">
                                            <a href="index.html" class="text-dark font-size-22 font-family-secondary">
                                                <b>@Model.Title</b>
                                            </a>
                                        </div>

                                        <div class="text-center">
                                            <img src="@Model.ImageUrl" alt="error" height="180">
                                            <h1 class="h4 mb-3 mt-4">Giá: <span class="text-success">@Model.Price</span></h1>
                                            <p class="text-muted mb-4 w-75 m-auto">@Model.Description, chờ hết thời gian đếm ngược để nhận tiền</p>
                                            <div class="alert alert-danger mt-3 tab_error" role="alert" style="display: none">
                                                Bạn đã đóng tab, vui lòng thực hiện lại!
                                            </div>
                                        </div>
                                        
                                        <div class="row mt-4">
                                            <div class="col-12 text-center">
                                                <button type="button" class="btn btn-light waves-effect waves-light"><i class="fas fa-home"></i> Về trang chủ</button>
                                                <button type="button" class="btn btn-danger waves-effect waves-light"> Bỏ qua</button>
                                                <button id="goto" type="button" class="btn btn-success waves-effect waves-light button"><i class="far fa-eye"></i> Xem quảng cáo</button>

                                            </div> <!-- end col -->
                                        </div>
                                        <!-- end row -->
                                    </div> <!-- end .padding-5 -->
                                </div> <!-- end col -->
                            </div> <!-- end row -->
                        </div> <!-- end .w-100 -->
                    </div> <!-- end .d-flex -->
                </div> <!-- end col-->
            </div> <!-- end row -->
        </div>
        <!-- end container -->
    </div>
    <!-- end page -->
    <!-- jQuery  -->
    <script src="~/content/vertical/assets/js/jquery.min.js"></script>
    <script src="~/content/vertical/assets/js/bootstrap.bundle.min.js"></script>
    <script src="~/content/vertical/assets/js/metismenu.min.js"></script>
    <script src="~/content/vertical/assets/js/waves.js"></script>
    <script src="~/content/vertical/assets/js/simplebar.min.js"></script>

    <!-- App js -->
    <script src="~/content/vertical/assets/js/theme.js"></script>

    <script>
        var counter = 15;
        var interval;
        var window_tab;
        var t, count;
        var COUNT = 15;

        document.getElementById('goto').onclick = function () {
            $('.tab_error').css('display', 'none');
            cdreset();
            countdown();
            window_tab = window.open('@Model.Url');
            if (typeof window_tab == 'undefined' || window_tab == null) {
                cdreset();
                cdpause();
                alert('Lỗi! Có vẻ như cửa sổ không mở trên thiết bị của bạn. Vui lòng tải lại trang này.');
                return;
            }
            else if (window_tab.closed === false) {
                //alert('Bạn đã đóng tab!');
                //$('.loading').fadeIn();
                //$('.button').remove();
                //tmr.innerHTML = sec_left(counter);
                interval = setInterval(function () {
                    if (window_tab.closed === true) {
                        $('.tab_error').css('display', 'block');
                        cdpause();
                        //tmr.innerHTML = 'Bạn đã đóng tab!';
                        //$('.lds-spinner').remove();
                        //document.title = 'Bạn đã đóng tab!';
                        clearInterval(interval);
                    }
                    else if (counter > 0) {
                        counter--;
                        //document.title = sec_left(counter) + ' | KHÔNG ĐÓNG TAB!';
                        //tmr.innerHTML = sec_left(counter);
                    }
                    // Display 'counter' wherever you want to display it.
                    else if (counter === 0) {
                        clearInterval(interval);
                        alert('ok');
                        //$.ajax({
                        //    'url': 'https://olacity.com/surfAds/back_money',
                        //    headers: {
                        //        'X-CSRF-TOKEN': 'jnSk52WFtSMRbGdWUrxRKNMotYUvhHZaaeu4nlVC'
                        //    },
                        //    data: {
                        //        "surf_ads_id": "eyJpdiI6IitYaG9nRHpTd21VdWxTZmtuMkZJTVE9PSIsInZhbHVlIjoiQVFhNGRFMEtuckp0QmUyWHFcL2NBVmw1Ujh4YVNZdW5SQ282b1RLRmtSaWc9IiwibWFjIjoiMDhiZjU1ZmJiZTU0NmFlNTdmYWU2MzM3MTgzYmZhYzUzMzRlNmI4YzdjYjIyMTk0MjkyNjYyMTY0YTU4MWZkOCJ9",
                        //    },
                        //    'type': 'POST',
                        //    'success': function (response) {
                        //        clearInterval(counter);
                        //        if (response.status === 400 || response.status === 403) {
                        //            notif({
                        //                msg: response.msg,
                        //                type: "error",
                        //                timeout: 5000
                        //            });

                        //            setTimeout(function () {
                        //                window.location.reload();
                        //            }, 5000);
                        //        }
                        //        else if (response.status === 201) {
                        //            notif({
                        //                msg: response.msg,
                        //                type: "success"
                        //            });
                        //            setTimeout(function () {
                        //                window.location.reload();
                        //            }, 1700);
                        //        }
                        //        else {
                        //            notif({
                        //                msg: 'Cộng tiền không thành công, vui lòng tải lại trang',
                        //                type: "error"
                        //            });
                        //            setTimeout(function () {
                        //                window.location.reload();
                        //            }, 5000);
                        //        }
                        //        return true;
                        //    },
                        //    error: function (xhr, status, error) {
                        //        var err = xhr.responseText;
                        //        notif({
                        //            msg: err,
                        //            type: "error"
                        //        });
                        //        setTimeout(function () {
                        //            window.location.reload();
                        //        }, 5000);
                        //    }
                        //});
                    }
                }, 1000);
            }
        }
    </script>

    <script>
        $(document).ready(function () {
            cdreset();
        });
        function cddisplay() {
            $('.timer-display').html("00:" + (count < 10 ? '0' : '') + count);
        }

        function countdown() {
            // starts countdown
            cddisplay();
            if (count === 0) {
                // time is up
            } else {
                count--;
                t = setTimeout(countdown, 1000);
            }
        }

        function cdpause() {
            // pauses countdown
            clearTimeout(t);
        }

        function cdreset() {
            // resets countdown
            cdpause();
            count = COUNT;
            cddisplay();
        }
    </script>

</body>
</html>
